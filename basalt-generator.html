<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Basalt UI Designer</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="logo">
                    <span class="logo-icon">‚ö°</span>
                    <span id="logoTitle">Basalt 2 UI Designer</span>
                </h1>
                <!-- Framework Tabs -->
                <div class="framework-tabs">
                    <button class="tab-btn active" data-framework="basalt">Basalt</button>
                    <button class="tab-btn" data-framework="pixelui">PixelUI</button>
                    <button class="tab-btn" data-framework="kubeui">KubeUI</button>
                    <button class="tab-btn" data-framework="primeui">PrimeUI</button>
                </div>
            </div>
            <div class="header-center">
                <div class="terminal-size-controls">
                    <label for="terminalPreset">Terminal Size:</label>
                    <select id="terminalPreset" class="preset-select">
                        <option value="custom">Custom</option>
                        <option value="computer" selected>Computer (51x19)</option>
                        <option value="pocket">Pocket Computer (26x20)</option>
                        <option value="monitor">Monitor 2x2 (7x5)</option>
                        <option value="monitor3x2">Monitor 3x2 (10x6)</option>
                        <option value="monitor5x4">Monitor 5x4 (16x12)</option>
                    </select>
                    <div class="size-inputs">
                        <input type="number" id="terminalWidth" min="1" max="164" value="51" placeholder="Width">
                        <span>√ó</span>
                        <input type="number" id="terminalHeight" min="1" max="81" value="19" placeholder="Height">
                    </div>
                </div>
            </div>
            <div class="header-right">
                <button class="btn btn-secondary sidebar-toggle" id="leftSidebarToggle" title="Toggle Element Palette">
                    üì¶ Elements
                </button>
                <button class="btn btn-secondary sidebar-toggle" id="rightSidebarToggle" title="Toggle Properties Panel">
                    ‚öôÔ∏è Properties
                </button>
                <button class="btn btn-secondary" onclick="designer.undo()" title="Undo (Ctrl+Z)">‚Ü∂ Undo</button>
                <button class="btn btn-secondary" onclick="designer.redo()" title="Redo (Ctrl+Y)">‚Ü∑ Redo</button>
                <button class="btn btn-secondary" onclick="window.location.href='projects.html'">
                    üìÅ Projects
                </button>
                <button class="btn btn-secondary" onclick="designer.quickSave()">
                    üíæ Save
                </button>
                <button class="btn btn-secondary" id="exportBtn">
                    üì• Export Code
                </button>
                <button class="btn btn-secondary" id="importBtn">
                    üì§ Import
                </button>
                <button class="btn btn-primary" id="previewBtn">
                    üëÅÔ∏è Live Preview
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar - Element Palette -->
            <aside class="sidebar left-sidebar" id="leftSidebar">
                <div class="sidebar-header">
                    <h3>Elements</h3>
                    <button class="sidebar-close" id="leftSidebarClose" title="Close Elements Panel">√ó</button>
                </div>
                <div class="sidebar-section">
                    <div class="element-palette">
                        <!-- Container Elements -->
                        <div class="element-category">
                            <h4>Containers</h4>
                            <div class="element-grid">
                                <div class="element-item" data-type="Frame">
                                    <div class="element-icon">üñºÔ∏è</div>
                                    <span>Frame</span>
                                </div>
                                <div class="element-item" data-type="Container">
                                    <div class="element-icon">üì¶</div>
                                    <span>Container</span>
                                </div>
                                <div class="element-item" data-type="Flexbox">
                                    <div class="element-icon">üìê</div>
                                    <span>Flexbox</span>
                                </div>
                            </div>
                        </div>

                        <!-- Basic Elements -->
                        <div class="element-category">
                            <h4>Basic</h4>
                            <div class="element-grid">
                                <div class="element-item" data-type="Label">
                                    <div class="element-icon">üè∑Ô∏è</div>
                                    <span>Label</span>
                                </div>
                                <div class="element-item" data-type="Button">
                                    <div class="element-icon">üîò</div>
                                    <span>Button</span>
                                </div>
                                <div class="element-item" data-type="Input">
                                    <div class="element-icon">üìù</div>
                                    <span>Input</span>
                                </div>
                                <div class="element-item" data-type="Checkbox">
                                    <div class="element-icon">‚òëÔ∏è</div>
                                    <span>Checkbox</span>
                                </div>
                                <div class="element-item" data-type="Switch">
                                    <div class="element-icon">üîÄ</div>
                                    <span>Switch</span>
                                </div>
                                <div class="element-item" data-type="Image">
                                    <div class="element-icon">üñºÔ∏è</div>
                                    <span>Image</span>
                                </div>
                            </div>
                        </div>

                        <!-- Advanced Elements -->
                        <div class="element-category">
                            <h4>Advanced</h4>
                            <div class="element-grid">
                                <div class="element-item" data-type="List">
                                    <div class="element-icon">üìã</div>
                                    <span>List</span>
                                </div>
                                <div class="element-item" data-type="Table">
                                    <div class="element-icon">üìä</div>
                                    <span>Table</span>
                                </div>
                                <div class="element-item" data-type="TabControl">
                                    <div class="element-icon">üìë</div>
                                    <span>TabControl</span>
                                </div>
                                <div class="element-item" data-type="Tree">
                                    <div class="element-icon">üå≥</div>
                                    <span>Tree</span>
                                </div>
                                <div class="element-item" data-type="Dropdown">
                                    <div class="element-icon">üìã</div>
                                    <span>Dropdown</span>
                                </div>
                                <div class="element-item" data-type="Menu">
                                    <div class="element-icon">üçî</div>
                                    <span>Menu</span>
                                </div>
                                <div class="element-item" data-type="TextBox">
                                    <div class="element-icon">üìÑ</div>
                                    <span>TextBox</span>
                                </div>
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="element-category">
                            <h4>Controls</h4>
                            <div class="element-grid">
                                <div class="element-item" data-type="Slider">
                                    <div class="element-icon">üéöÔ∏è</div>
                                    <span>Slider</span>
                                </div>
                                <div class="element-item" data-type="ProgressBar">
                                    <div class="element-icon">üìä</div>
                                    <span>Progress</span>
                                </div>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="element-category">
                            <h4>Charts</h4>
                            <div class="element-grid">
                                <div class="element-item" data-type="Graph">
                                    <div class="element-icon">üìà</div>
                                    <span>Graph</span>
                                </div>
                                <div class="element-item" data-type="BarChart">
                                    <div class="element-icon">üìä</div>
                                    <span>Bar Chart</span>
                                </div>
                                <div class="element-item" data-type="LineChart">
                                    <div class="element-icon">üìà</div>
                                    <span>Line Chart</span>
                                </div>
                            </div>
                        </div>

                        <!-- Special -->
                        <div class="element-category">
                            <h4>Special</h4>
                            <div class="element-grid">
                                <div class="element-item" data-type="Display">
                                    <div class="element-icon">üñ•Ô∏è</div>
                                    <span>Display</span>
                                </div>
                                <div class="element-item" data-type="BigFont">
                                    <div class="element-icon">üî§</div>
                                    <span>BigFont</span>
                                </div>
                                <div class="element-item" data-type="Program">
                                    <div class="element-icon">üíª</div>
                                    <span>Program</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Canvas Area -->
            <main class="canvas-area">
                <div class="canvas-header">
                    <div class="canvas-title">
                        <h3>Design Canvas</h3>
                        <span class="canvas-info" id="canvasInfo">51√ó19 Computer Terminal</span>
                    </div>
                    <div class="canvas-controls">
                        <button class="btn btn-sm" id="gridToggle">üìê Grid</button>
                        <button class="btn btn-sm" id="clearCanvas">üóëÔ∏è Clear</button>
                        <!-- KubeUI Font Toggle -->
                        <div class="kubeui-font-toggle" id="kubeUIFontToggle" style="display: none;">
                            <label for="fontModeSelect">Font:</label>
                            <select id="fontModeSelect">
                                <option value="cc">CC Font</option>
                                <option value="kube">Kube Font (2.5x)</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="canvas-container">
                    <div class="canvas" id="canvas">
                        <div class="terminal-preview" id="terminalPreview">
                            <!-- Terminal grid will be generated here -->
                        </div>
                        <div class="drop-zone" id="dropZone">
                            <div class="drop-zone-content">
                                <div class="drop-zone-icon">üé®</div>
                                <h3>Start Designing</h3>
                                <p>Drag elements from the sidebar to begin creating your Basalt UI</p>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Properties Panel -->
            <aside class="properties-panel right-sidebar" id="rightSidebar">
                <div class="properties-header">
                    <h3>Properties</h3>
                    <div class="sidebar-controls">
                        <button class="btn btn-sm" id="hierarchyBtn">üå≤ Hierarchy</button>
                        <button class="sidebar-close" id="rightSidebarClose" title="Close Properties Panel">√ó</button>
                    </div>
                </div>
                <div class="properties-content" id="propertiesContent">
                    <div class="no-selection">
                        <div class="no-selection-icon">üéØ</div>
                        <p>Select an element to edit its properties</p>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Sidebar Overlay for mobile -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Modals -->
        <!-- Export Modal -->
        <div class="modal large" id="exportModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üöÄ Export Your Design</h3>
                    <button class="modal-close" data-modal="exportModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="export-intro">
                        <p>Choose your preferred export format and get ready-to-use code for your ComputerCraft project.</p>
                    </div>
                    
                    <div class="export-format-selector">
                        <h4>üì¶ Export Format</h4>
                        <div class="export-options">
                            <div class="export-option active" data-format="lua">
                                <input type="radio" id="exportLua" name="exportType" value="lua" checked>
                                <label for="exportLua">
                                    <div class="export-option-icon">üîß</div>
                                    <div class="export-option-content">
                                        <strong>Lua Code</strong>
                                        <small>Ready-to-run Basalt script</small>
                                    </div>
                                </label>
                            </div>
                            <div class="export-option" data-format="json">
                                <input type="radio" id="exportJSON" name="exportType" value="json">
                                <label for="exportJSON">
                                    <div class="export-option-icon">üìÑ</div>
                                    <div class="export-option-content">
                                        <strong>JSON Data</strong>
                                        <small>Structured data format</small>
                                    </div>
                                </label>
                            </div>
                            <div class="export-option" data-format="xml">
                                <input type="radio" id="exportXML" name="exportType" value="xml">
                                <label for="exportXML">
                                    <div class="export-option-icon">üè∑Ô∏è</div>
                                    <div class="export-option-content">
                                        <strong>XML Format</strong>
                                        <small>Basalt plugin compatible</small>
                                    </div>
                                </label>
                            </div>
                            <div class="export-option" data-format="xcc">
                                <input type="radio" id="exportXCC" name="exportType" value="xcc">
                                <label for="exportXCC">
                                    <div class="export-option-icon">üíé</div>
                                    <div class="export-option-content">
                                        <strong>XCC Project</strong>
                                        <small>Re-editable project file</small>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="export-options-panel">
                        <h4>‚öôÔ∏è Export Options</h4>
                        <div class="option-group">
                            <div class="option-item">
                                <input type="checkbox" id="smartMargins" onchange="designer.updateExportCode()">
                                <label for="smartMargins">
                                    <div class="option-content">
                                        <strong>üîß Smart Margins</strong>
                                        <small>Automatically adapt positioning and sizing for different screen sizes. Perfect for making your UI work on both Normal Computers (51√ó19) and Pocket Computers (26√ó20), or any other terminal sizes. The generated code will dynamically calculate positions and sizes based on screen ratios.</small>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="export-preview">
                        <div class="export-preview-header">
                            <h4>üìã Generated Code</h4>
                            <div class="export-stats">
                                <span id="codeLines">0 lines</span>
                                <span id="codeSize">0 bytes</span>
                            </div>
                        </div>
                        <div class="code-output">
                            <pre><code id="exportCode" class="language-lua"></code></pre>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="btn btn-secondary" data-modal="exportModal">Cancel</button>
                        <button class="btn btn-action" id="copyCodeBtn">
                            <span>üìã Copy to Clipboard</span>
                        </button>
                        <button class="btn btn-primary" id="downloadCodeBtn">
                            <span>üíæ Download File</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Import Modal -->
        <div class="modal" id="importModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üì• Import Design</h3>
                    <button class="modal-close" data-modal="importModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="import-intro">
                        <p>Choose how you'd like to import your design. You can upload a file or paste code directly.</p>
                    </div>
                    
                    <div class="import-options">
                        <div class="import-method file-method">
                            <div class="import-method-header">
                                <div class="import-icon">üìÅ</div>
                                <div>
                                    <h4>Upload File</h4>
                                    <p>Import from .xcc, .json, .lua, or .xml files</p>
                                </div>
                            </div>
                            <div class="file-drop-zone">
                                <input type="file" id="importFile" accept=".json,.lua,.xml,.xcc">
                                <div class="file-drop-content">
                                    <div class="upload-icon">‚¨ÜÔ∏è</div>
                                    <p><strong>Click to browse</strong> or drag & drop your file here</p>
                                    <small>Supports .xcc, .json, .lua, .xml files</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="import-divider">
                            <span>OR</span>
                        </div>
                        
                        <div class="import-method code-method">
                            <div class="import-method-header">
                                <div class="import-icon">üìù</div>
                                <div>
                                    <h4>Paste Code</h4>
                                    <p>Directly paste your code or JSON data</p>
                                </div>
                            </div>
                            <div class="code-input-container">
                                <textarea id="importCode" placeholder="Paste your Basalt code, JSON, or XML here..."></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="btn btn-secondary" data-modal="importModal">Cancel</button>
                        <button class="btn btn-primary" id="performImport">
                            <span>üöÄ Import Design</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Preview Modal -->
        <div class="modal large" id="previewModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Live Preview</h3>
                    <div class="preview-controls">
                        <button class="btn btn-sm" id="refreshPreview">üîÑ Refresh</button>
                        <button class="modal-close" data-modal="previewModal">&times;</button>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="preview-container">
                        <div class="terminal-simulation" id="terminalSimulation">
                            <!-- Live preview will be rendered here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Element Hierarchy Modal -->
        <div class="modal" id="hierarchyModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Element Hierarchy</h3>
                    <button class="modal-close" data-modal="hierarchyModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="hierarchy-tree" id="hierarchyTree">
                        <!-- Element hierarchy will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart Designer Modal -->
        <div class="modal large" id="chartDesignerModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üìä Chart Designer</h3>
                    <button class="modal-close" data-modal="chartDesignerModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="chart-designer-container">
                        <div class="chart-config-panel">
                            <h4>Chart Configuration</h4>
                            
                            <!-- Chart Type Selection -->
                            <div class="config-group">
                                <label>Chart Type:</label>
                                <select id="chartTypeSelect">
                                    <option value="line">Line Chart</option>
                                    <option value="bar">Bar Chart</option>
                                    <option value="pie">Pie Chart</option>
                                    <option value="area">Area Chart</option>
                                </select>
                            </div>
                            
                            <!-- Chart Properties -->
                            <div class="config-group">
                                <label>Title:</label>
                                <input type="text" id="chartTitle" placeholder="Chart Title">
                            </div>
                            
                            <div class="config-group">
                                <label>X-Axis Label:</label>
                                <input type="text" id="chartXLabel" placeholder="X-Axis Label">
                            </div>
                            
                            <div class="config-group">
                                <label>Y-Axis Label:</label>
                                <input type="text" id="chartYLabel" placeholder="Y-Axis Label">
                            </div>
                            
                            <!-- Data Series Management -->
                            <div class="config-group">
                                <h5>Data Series</h5>
                                <div class="series-controls">
                                    <button class="btn btn-sm" onclick="designer.addChartSeries()">+ Add Series</button>
                                    <button class="btn btn-sm" onclick="designer.generateSampleData()">üìä Sample Data</button>
                                </div>
                                <div id="seriesList" class="series-list">
                                    <!-- Data series will be added here -->
                                </div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="chart-actions">
                                <button class="btn btn-primary" onclick="designer.applyChartDesign()">Apply Design</button>
                                <button class="btn btn-secondary" onclick="designer.cancelChartDesign()">Cancel</button>
                                <button class="btn btn-secondary" onclick="designer.resetChartData()">Reset</button>
                            </div>
                        </div>
                        
                        <div class="chart-preview-panel">
                            <h4>Preview</h4>
                            <div id="chartPreview" class="chart-preview">
                                <!-- Chart preview will be rendered here -->
                            </div>
                            <div class="preview-info">
                                <small>Preview shows approximate representation</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TreeView Designer Modal -->
        <div class="modal large" id="treeDesignerModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üå≥ TreeView Designer</h3>
                    <button class="modal-close" data-modal="treeDesignerModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="tree-designer-container">
                        <div class="tree-config-panel">
                            <h4>Tree Configuration</h4>
                            
                            <!-- Tree Settings -->
                            <div class="config-group">
                                <h5>Tree Settings</h5>
                                <div class="form-group">
                                    <label for="treeShowLines">Show Lines</label>
                                    <input type="checkbox" id="treeShowLines" checked>
                                </div>
                                <div class="form-group">
                                    <label for="treeShowRoot">Show Root</label>
                                    <input type="checkbox" id="treeShowRoot" checked>
                                </div>
                                <div class="form-group">
                                    <label for="treeExpandable">Expandable</label>
                                    <input type="checkbox" id="treeExpandable" checked>
                                </div>
                                <div class="form-group">
                                    <label for="treeSelectable">Selectable</label>
                                    <input type="checkbox" id="treeSelectable" checked>
                                </div>
                            </div>
                            
                            <!-- Tree Structure Management -->
                            <div class="config-group">
                                <h5>Tree Structure</h5>
                                <div class="tree-controls">
                                    <button class="btn btn-sm" onclick="designer.addTreeNode()">+ Add Node</button>
                                    <button class="btn btn-sm" onclick="designer.generateSampleTree()">üå≥ Sample Tree</button>
                                </div>
                                
                                <!-- Current Node Editor -->
                                <div class="node-editor" id="nodeEditor" style="display: none;">
                                    <h6>Edit Node</h6>
                                    <div class="form-group">
                                        <label for="nodeText">Text</label>
                                        <input type="text" id="nodeText" placeholder="Node text">
                                    </div>
                                    <div class="form-group">
                                        <label for="nodeExpanded">Expanded</label>
                                        <input type="checkbox" id="nodeExpanded">
                                    </div>
                                    <div class="form-group">
                                        <label for="nodeIcon">Icon (optional)</label>
                                        <input type="text" id="nodeIcon" placeholder="üìÅ">
                                    </div>
                                    <div class="node-actions">
                                        <button class="btn btn-xs" onclick="designer.addChildNode()">+ Add Child</button>
                                        <button class="btn btn-xs" onclick="designer.deleteTreeNode()">üóëÔ∏è Delete</button>
                                        <button class="btn btn-xs" onclick="designer.moveNodeUp()">‚¨ÜÔ∏è Up</button>
                                        <button class="btn btn-xs" onclick="designer.moveNodeDown()">‚¨áÔ∏è Down</button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="tree-actions">
                                <button class="btn btn-primary" onclick="designer.applyTreeDesign()">Apply Design</button>
                                <button class="btn btn-secondary" onclick="designer.cancelTreeDesign()">Cancel</button>
                                <button class="btn btn-secondary" onclick="designer.resetTreeData()">Reset</button>
                            </div>
                        </div>
                        
                        <div class="tree-preview-panel">
                            <h4>Tree Structure</h4>
                            <div id="treePreview" class="tree-preview">
                                <!-- Tree preview will be rendered here -->
                            </div>
                            <div class="preview-info">
                                <small>Click nodes to edit, drag to reorder</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Framework Switch Warning Modal -->
        <div class="modal" id="frameworkSwitchModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>‚ö†Ô∏è Switch Framework</h3>
                    <button class="modal-close" data-modal="frameworkSwitchModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="warning-content">
                        <div class="warning-icon">üö®</div>
                        <div class="warning-message">
                            <h4>This action will clear your current design</h4>
                            <p>Switching frameworks will permanently delete all elements on the canvas. This action cannot be undone.</p>
                            
                            <div class="framework-switch-info">
                                <div class="current-framework">
                                    <strong>Current:</strong> <span id="currentFrameworkName">Basalt</span>
                                </div>
                                <div class="arrow">‚Üí</div>
                                <div class="target-framework">
                                    <strong>Switching to:</strong> <span id="targetFrameworkName">PixelUI</span>
                                </div>
                            </div>
                            
                            <div class="elements-count">
                                <span id="elementsCount">0</span> elements will be lost
                            </div>
                        </div>
                    </div>
                    
                    <div class="warning-actions">
                        <button class="btn btn-secondary" onclick="designer.cancelFrameworkSwitch()">
                            ‚ùå Cancel
                        </button>
                        <button class="btn btn-danger" onclick="designer.confirmFrameworkSwitch()">
                            üóëÔ∏è Delete All & Switch
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
